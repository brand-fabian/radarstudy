# snakemake-phasing
The phasing workflow is using `unfazed` and `WhatsHap` to assign the likely gamete of origin to many variants in all samples given in the VCF files passed in through the configuration. In its current form, this workflow is specialized to work with the data from the radarstudy. The final output table, which is used in the statistical analysis scripts ([cDNM Analysis](../analysis/cdnm-analysis.md#cdnm-analysis)) is generated by the python script [scripts/read_phasing/read_phasing.py], an example invocation is located next to it.

## Usage
This workflows only configuration is in `cluster.yaml` and `config.yaml`. Please adapt `cluster.yaml` to the requirements of your local HPC system or processing setup. Like in other workflows, the `config.yaml` contains paths to reference files, which should be adapted. In addition, this workflow can search through a set of directories (`search-dirs`), to find the required `.bam` input files for the phasing workflow. If this search takes to long, or if the sample name is not contained in the file paths, it is optionally possible to supply the path to a `files.tsv` table, which contains a mapping of sample names and bam file paths.

The main input of the workflow is the three VCF files, `cohort-vcf` in the `config.yaml` file. These files should contain _all_ variants that were called, since they are used to find potential candidates to reconstruct the parental haplotypes of each children. To perform the phasing, also a pedigree is required. In the end, the workflow will try to phase any variant given in the `sites` table, which should be any dnm table generated by a previous execution of the cDNM analysis script ([cDNM Analysis](../analysis/cdnm-analysis.md#cdnm-analysis)).